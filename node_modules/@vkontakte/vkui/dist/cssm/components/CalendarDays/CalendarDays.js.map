{"version":3,"sources":["../../../../src/components/CalendarDays/CalendarDays.tsx"],"sourcesContent":["'use client';\n\nimport * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport { isSameDay, isSameMonth } from 'date-fns';\nimport { useExternRef } from '../../hooks/useExternRef';\nimport { useTodayDate } from '../../hooks/useTodayDate';\nimport { getDaysNames, getWeeks } from '../../lib/calendar';\nimport type { HTMLAttributesWithRootRef } from '../../types';\nimport {\n  CalendarDay,\n  type CalendarDayElementProps,\n  type CalendarDayProps,\n  type CalendarDayTestsProps,\n} from '../CalendarDay/CalendarDay';\nimport { useConfigProvider } from '../ConfigProvider/ConfigProviderContext';\nimport { RootComponent } from '../RootComponent/RootComponent';\nimport { Footnote } from '../Typography/Footnote/Footnote';\nimport styles from './CalendarDays.module.css';\n\nexport type CalendarDaysTestsProps = {\n  /**\n   * Передает атрибут `data-testid` для дня в календаре\n   */\n  dayTestId?: CalendarDayTestsProps['testId'];\n};\n\nexport interface CalendarDaysProps\n  extends Omit<HTMLAttributesWithRootRef<HTMLDivElement>, 'onChange'>,\n    Pick<CalendarDayProps, 'renderDayContent'>,\n    CalendarDaysTestsProps {\n  value?: Date | Array<Date | null>;\n  viewDate: Date;\n  weekStartsOn: 0 | 1 | 2 | 3 | 4 | 5 | 6;\n  showNeighboringMonth?: boolean;\n  size?: 's' | 'm';\n  dayProps?: CalendarDayElementProps;\n  listenDayChangesForUpdate?: boolean;\n  onDayChange: (value: Date) => void;\n  isDayDisabled: (value: Date) => boolean;\n  isDaySelectionStart: (value: Date, dayOfWeek: number) => boolean;\n  isDaySelectionEnd: (value: Date, dayOfWeek: number) => boolean;\n  isHintedDaySelectionStart?: (value: Date, dayOfWeek: number) => boolean;\n  isHintedDaySelectionEnd?: (value: Date, dayOfWeek: number) => boolean;\n  isDayActive: (value: Date) => boolean;\n  isDayHinted?: (value: Date) => boolean;\n  isDaySelected?: (value: Date) => boolean;\n  isDayFocused: (value: Date) => boolean;\n  onDayEnter?: (value: Date) => void;\n  onDayLeave?: (value: Date) => void;\n}\n\nexport const CalendarDays = ({\n  viewDate,\n  value,\n  weekStartsOn,\n  onDayChange,\n  isDaySelected,\n  isDayActive,\n  isDaySelectionEnd,\n  isDaySelectionStart,\n  onDayEnter,\n  onDayLeave,\n  isDayHinted,\n  isHintedDaySelectionStart,\n  isHintedDaySelectionEnd,\n  isDayFocused,\n  isDayDisabled,\n  size,\n  showNeighboringMonth = false,\n  dayProps,\n  listenDayChangesForUpdate = false,\n  getRootRef,\n  renderDayContent,\n  dayTestId,\n  ...props\n}: CalendarDaysProps): React.ReactNode => {\n  const { locale } = useConfigProvider();\n  const ref = useExternRef(getRootRef);\n  const now = useTodayDate(listenDayChangesForUpdate);\n\n  const weeks = React.useMemo(() => getWeeks(viewDate, weekStartsOn), [weekStartsOn, viewDate]);\n\n  const daysNames = React.useMemo(\n    () => getDaysNames(now, weekStartsOn, locale),\n    [locale, now, weekStartsOn],\n  );\n\n  const handleDayChange = React.useCallback(\n    (date: Date) => {\n      onDayChange(date);\n\n      ref.current?.focus();\n    },\n    [onDayChange, ref],\n  );\n\n  return (\n    <RootComponent {...props} baseClassName={styles.host} getRootRef={ref}>\n      <div className={classNames(styles.row, size === 's' && styles.rowSizeS)}>\n        {daysNames.map((dayName) => (\n          <Footnote key={dayName} className={styles.weekday}>\n            {dayName}\n          </Footnote>\n        ))}\n      </div>\n\n      {weeks.map((week, i) => (\n        <div className={classNames(styles.row, size === 's' && styles.rowSizeS)} key={i}>\n          {week.map((day, i) => {\n            const sameMonth = isSameMonth(day, viewDate);\n            return (\n              <CalendarDay\n                key={day.toISOString()}\n                day={day}\n                today={isSameDay(day, now)}\n                active={isDayActive(day)}\n                onChange={handleDayChange}\n                hidden={!showNeighboringMonth && !sameMonth}\n                disabled={isDayDisabled(day)}\n                selectionStart={isDaySelectionStart(day, i)}\n                selectionEnd={isDaySelectionEnd(day, i)}\n                hintedSelectionStart={isHintedDaySelectionStart?.(day, i)}\n                hintedSelectionEnd={isHintedDaySelectionEnd?.(day, i)}\n                selected={isDaySelected?.(day)}\n                focused={isDayFocused(day)}\n                onEnter={onDayEnter}\n                onLeave={onDayLeave}\n                hinted={isDayHinted?.(day)}\n                sameMonth={sameMonth}\n                size={size}\n                renderDayContent={renderDayContent}\n                testId={dayTestId}\n                {...dayProps}\n                className={classNames(dayProps?.className, styles.rowDay)}\n              />\n            );\n          })}\n        </div>\n      ))}\n    </RootComponent>\n  );\n};\n"],"names":["React","classNames","isSameDay","isSameMonth","useExternRef","useTodayDate","getDaysNames","getWeeks","CalendarDay","useConfigProvider","RootComponent","Footnote","styles","CalendarDays","viewDate","value","weekStartsOn","onDayChange","isDaySelected","isDayActive","isDaySelectionEnd","isDaySelectionStart","onDayEnter","onDayLeave","isDayHinted","isHintedDaySelectionStart","isHintedDaySelectionEnd","isDayFocused","isDayDisabled","size","showNeighboringMonth","dayProps","listenDayChangesForUpdate","getRootRef","renderDayContent","dayTestId","props","locale","ref","now","weeks","useMemo","daysNames","handleDayChange","useCallback","date","current","focus","baseClassName","host","div","className","row","rowSizeS","map","dayName","weekday","week","i","day","sameMonth","today","active","onChange","hidden","disabled","selectionStart","selectionEnd","hintedSelectionStart","hintedSelectionEnd","selected","focused","onEnter","onLeave","hinted","testId","rowDay","toISOString"],"mappings":"AAAA;;AAEA,YAAYA,WAAW,QAAQ;AAC/B,SAASC,UAAU,QAAQ,kBAAkB;AAC7C,SAASC,SAAS,EAAEC,WAAW,QAAQ,WAAW;AAClD,SAASC,YAAY,QAAQ,8BAA2B;AACxD,SAASC,YAAY,QAAQ,8BAA2B;AACxD,SAASC,YAAY,EAAEC,QAAQ,QAAQ,wBAAqB;AAE5D,SACEC,WAAW,QAIN,gCAA6B;AACpC,SAASC,iBAAiB,QAAQ,6CAA0C;AAC5E,SAASC,aAAa,QAAQ,oCAAiC;AAC/D,SAASC,QAAQ,QAAQ,qCAAkC;AAC3D,OAAOC,YAAY,4BAA4B;AAkC/C,OAAO,MAAMC,eAAe,CAAC,EAC3BC,QAAQ,EACRC,KAAK,EACLC,YAAY,EACZC,WAAW,EACXC,aAAa,EACbC,WAAW,EACXC,iBAAiB,EACjBC,mBAAmB,EACnBC,UAAU,EACVC,UAAU,EACVC,WAAW,EACXC,yBAAyB,EACzBC,uBAAuB,EACvBC,YAAY,EACZC,aAAa,EACbC,IAAI,EACJC,uBAAuB,KAAK,EAC5BC,QAAQ,EACRC,4BAA4B,KAAK,EACjCC,UAAU,EACVC,gBAAgB,EAChBC,SAAS,EACT,GAAGC,OACe;IAClB,MAAM,EAAEC,MAAM,EAAE,GAAG5B;IACnB,MAAM6B,MAAMlC,aAAa6B;IACzB,MAAMM,MAAMlC,aAAa2B;IAEzB,MAAMQ,QAAQxC,MAAMyC,OAAO,CAAC,IAAMlC,SAASO,UAAUE,eAAe;QAACA;QAAcF;KAAS;IAE5F,MAAM4B,YAAY1C,MAAMyC,OAAO,CAC7B,IAAMnC,aAAaiC,KAAKvB,cAAcqB,SACtC;QAACA;QAAQE;QAAKvB;KAAa;IAG7B,MAAM2B,kBAAkB3C,MAAM4C,WAAW,CACvC,CAACC;QACC5B,YAAY4B;QAEZP,IAAIQ,OAAO,EAAEC;IACf,GACA;QAAC9B;QAAaqB;KAAI;IAGpB,qBACE,MAAC5B;QAAe,GAAG0B,KAAK;QAAEY,eAAepC,OAAOqC,IAAI;QAAEhB,YAAYK;;0BAChE,KAACY;gBAAIC,WAAWlD,WAAWW,OAAOwC,GAAG,EAAEvB,SAAS,OAAOjB,OAAOyC,QAAQ;0BACnEX,UAAUY,GAAG,CAAC,CAACC,wBACd,KAAC5C;wBAAuBwC,WAAWvC,OAAO4C,OAAO;kCAC9CD;uBADYA;;YAMlBf,MAAMc,GAAG,CAAC,CAACG,MAAMC,kBAChB,KAACR;oBAAIC,WAAWlD,WAAWW,OAAOwC,GAAG,EAAEvB,SAAS,OAAOjB,OAAOyC,QAAQ;8BACnEI,KAAKH,GAAG,CAAC,CAACK,KAAKD;wBACd,MAAME,YAAYzD,YAAYwD,KAAK7C;wBACnC,qBACE,KAACN;4BAECmD,KAAKA;4BACLE,OAAO3D,UAAUyD,KAAKpB;4BACtBuB,QAAQ3C,YAAYwC;4BACpBI,UAAUpB;4BACVqB,QAAQ,CAAClC,wBAAwB,CAAC8B;4BAClCK,UAAUrC,cAAc+B;4BACxBO,gBAAgB7C,oBAAoBsC,KAAKD;4BACzCS,cAAc/C,kBAAkBuC,KAAKD;4BACrCU,sBAAsB3C,4BAA4BkC,KAAKD;4BACvDW,oBAAoB3C,0BAA0BiC,KAAKD;4BACnDY,UAAUpD,gBAAgByC;4BAC1BY,SAAS5C,aAAagC;4BACtBa,SAASlD;4BACTmD,SAASlD;4BACTmD,QAAQlD,cAAcmC;4BACtBC,WAAWA;4BACX/B,MAAMA;4BACNK,kBAAkBA;4BAClByC,QAAQxC;4BACP,GAAGJ,QAAQ;4BACZoB,WAAWlD,WAAW8B,UAAUoB,WAAWvC,OAAOgE,MAAM;2BArBnDjB,IAAIkB,WAAW;oBAwB1B;mBA7B4EnB;;;AAkCtF,EAAE"}